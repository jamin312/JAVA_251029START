<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.book.mapper.BookMapper">

	<!-- 도서 등록 -->
	<insert id="regiBook">
		<selectKey keyProperty="bookNo" order="BEFORE" resultType="Long">
	      SELECT seq_book.nextval
	      FROM   dual
	    </selectKey>
		INSERT INTO book_tbl_06 (book_no, book_name, book_coverimg, book_date, book_price, book_publisher, book_info)
		VALUES (#{bookNo}, #{bookName}, #{bookCoverimg}, #{bookDate}, #{bookPrice}, #{bookPublisher}, #{bookInfo}) 
	</insert>
	
	<select id="getList">
		SELECT * FROM book_tbl_06
		ORDER BY book_no ASC
	</select>
	
	<select id="getRent">
		SELECT r.book_no AS book_no, b.book_name AS book_name, SUM(r.rent_price) AS rent_price, COUNT(*) AS rent_count
        FROM rent_tbl_06 r JOIN book_tbl_06 b
                             ON r.book_no = b.book_no
        GROUP BY r.book_no, b.book_name
	</select>
	
</mapper>